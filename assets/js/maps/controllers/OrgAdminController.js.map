{"version":3,"sources":["controllers/OrgAdminController.coffee"],"names":[],"mappings":"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","file":"controllers/OrgAdminController.js","sourceRoot":"/source/","sourcesContent":["'use strict'\n\nangular.module('subzapp').controller('OrgAdminController', [\n  '$scope'\n  '$rootScope'\n  '$state'\n  'COMMS'\n  'user'\n  'RESOURCES'\n  'alertify'\n  'Upload'\n  'usSpinnerService'\n  'uiGmapGoogleMapApi'\n  ( $scope, $rootScope, $state, COMMS, user, RESOURCES, alertify, Upload, usSpinnerService, uiGmapGoogleMapApi ) ->\n    check_club_admin = ( user ) ->\n      if !user.club_admin\n        $state.go 'login' \n        alertify.error 'You are not a club admin. Contact subzapp admin team for assitance'\n\n    $scope.location = {}\n    console.log 'OrgAdmin Controller'\n\n\n    user_token = window.localStorage.getItem 'user_token'\n    user.get_user().then ( (res) ->\n      # console.log \"Got user \"\n      check_club_admin($rootScope.USER)\n      # console.log window.USER.orgs.length == 0\n      # $scope.org = $rootScope.USER.orgs[0]\n      # console.log \"org id #{ JSON.stringify $scope.org }\"\n      $scope.user = $rootScope.USER\n      $scope.orgs = $rootScope.USER.orgs\n      $scope.show_team_admin = ( $rootScope.USER.org.length == 0 )\n      $scope.show_map = true #display map\n\n\n      if $rootScope.USER.org.length > 0  # if org is defined fetch org info with teams info and s3 info\n        \n        COMMS.GET(\n          \"/org/#{ $rootScope.USER.org[0].id }\"\n        ).then ( ( org_and_teams ) ->\n          usSpinnerService.stop('spinner-1')\n          console.log \"Get org and teams\"\n          console.log org_and_teams\n          $scope.teams = org_and_teams.data.org.teams\n          $scope.files = org_and_teams.data.s3_object.Contents\n          $scope.org = org_and_teams.data.org\n          $scope.locations = org_and_teams.data.org.org_locations\n          console.log \"Locations\"\n          console.log $scope.locations\n        ), ( errResponse ) ->\n          \n          console.log \"Get teams failed\"\n          console.log  errResponse\n          alertify.error 'Failed to fetch teams'\n    )\n\n    $scope.view_team = ( id ) -> # go to team page after clicking html link\n      window.localStorage.setItem 'team_id', id\n      $state.go 'team_manager'\n\n    $scope.org_create = -> # create a new org\n      # console.log \"create #{JSON.stringify user}\"\n\n      $scope.business_form_data.user_id = $rootScope.USER.id\n      \n      $scope.business_form_data.user_id = window.localStorage.getItem 'user_id'\n      console.log \"Form data #{ JSON.stringify $scope.business_form_data }\"\n      COMMS.POST(\n        '/org', $scope.business_form_data          \n      ).then ( (response) ->\n\n        # console.log \"Business create return \"\n        console.log response\n        $scope.orgs = response.data.user.orgs\n        $scope.org = response.data.org\n        $rootScope.USER = response.data.user\n\n        $scope.show_team_admin = response.data.user.org\n        \n        console.log \"Org set: #{ JSON.stringify $scope.org }\"\n        alertify.success \"Club created successfully\"\n        # $scope.business_form.$setPristine()\n        $('.business_name').val \"\"\n        $('.business_address').val \"\"\n\n      ), ( errResponse ) ->\n        console.log \"Business create error response #{ JSON.stringify errResponse }\"\n        $state.go 'login'\n\n    $scope.edit_org = ( id ) ->  #update org details\n \n      console.log \"Org #{ JSON.stringify $scope.org }\"\n\n      $scope.show_team_admin = false\n      COMMS.GET(\n        '/org-admins', org_id: id\n      ).then ( ( response ) ->\n        console.log \"get org-admins\"\n        console.log response\n        \n        $scope.admins = response.data.admins\n        $scope.teams = response.data.teams\n      ), ( errResponse ) ->\n        console.log \"Get org admins error\"\n        console.log errResponse\n\n    \n\n    $scope.team_create = ->  # create a team\n      console.log \"Org id #{ JSON.stringify $scope.org }\"\n      $scope.team_form_data.org_id = $scope.org.id\n      console.log \"Form data #{ JSON.stringify $scope.team_form_data }\"\n      COMMS.POST(\n        '/team', $scope.team_form_data\n      ).then ( ( response ) ->\n        console.log \"Team create\"\n        console.log response\n        alertify.success response.data.message\n        $scope.teams = response.data.org.teams\n        $scope.team_form.$setPristine()\n        $scope.team_form_data = ''\n      ), ( errResponse ) ->\n        console.log \"Team create error\"\n        console.log errResponse\n        alertify.error errResponse\n\n    $scope.delete_team = ( id ) -> # delete a team\n      COMMS.DELETE(\n          'team', team_id: id, org_id: $scope.org.id\n      ).then ( ( res ) ->\n        console.log \"Team delete\"\n        console.log res\n        $scope.teams = res.data.teams\n      ), ( errResponse ) ->\n        console.log \"Team delete error\"\n        console.log errResponse\n\n  ###########################################\n  # Upload a file                           #\n  ###########################################\n    \n\n    $scope.submit = ->\n      usSpinnerService.spin('spinner-1')\n      $scope.upload $scope.file\n\n    $scope.upload = (file) ->\n      console.log \"Upload\"\n      if ( $scope.file.info )?\n        \n        file_info = JSON.parse $scope.file.info\n        console.log \"Defined #{ file_info }\"\n        file_info = \n          org_id: $scope.org.id\n          team_id: file_info[0]\n          team_name: file_info[1]\n        console.log \"file_info #{ JSON.stringify file_info }\"\n      else\n        console.log \"Not defined \"\n        file_info = org_id: $scope.org.id\n      \n\n      # console.log \"File #{ JSON.stringify file_info[1] }\"\n      Upload.upload(\n        method: 'post'\n        url: '/file/upload'\n        data:\n          file_info\n\n        file: file     \n          \n      ).then ((resp) ->\n        usSpinnerService.stop('spinner-1')\n        console.log 'Success ' + JSON.stringify resp + 'uploaded. Response: ' + JSON.stringify resp.data\n        console.log resp\n        $scope.files = resp.data.bucket_info.Contents\n        alertify.success \"File uploaded ok\"\n        return\n      ), ((resp) ->\n        usSpinnerService.stop('spinner-1')\n        console.log 'Error status: ' + resp.status\n        alertify.error \"File failed to upload\"\n        console.log resp\n\n        alertify.error \"File upload failed. Status: #{ resp.status }\"\n        return\n      ), (evt) ->\n        progressPercentage = parseInt(100.0 * evt.loaded / evt.total)\n        console.log 'progress: ' + progressPercentage + '% ' + evt.config.data\n\n    \n    $scope.convert_date = ( date ) ->\n      console.log \"date #{ date }\"\n      console.log \"New date #{ moment( date ).format( \"DD-MM-YYYY\" ) }\"\n      return moment( date ).format( \"DD-MM-YYYY\" )\n\n  ###########################################\n  # map stuff                               #\n  ###########################################\n    display_info = -> # display instructions for setting clubs location\n      if $scope.org\n        alertify.log \"Enter your clubs address\"\n        setTimeout ( ->\n          alertify.log \"You can drag the map to fine tune your clubs position\"\n        ), 3000\n        \n        setTimeout ( -> \n          alertify.log \"Click save to upate the location\"\n        ), 6000\n\n    drag_display_info = -> #display instructions for dragging map to update location\n    \n      window.clearTimeout timeoutHandler\n        # create new timeout to fire sesarch function after 500ms (or whatever you like)\n      timeoutHandler = window.setTimeout((->\n        alertify.log \"You can save this new location\"\n        setTimeout ( ->\n          alertify.log \"Just click the Save Address button\"\n        ), 2000\n        return\n      ), 2500)\n      \n    \n\n    set_map = ( lat, lng, set_markers, zoom, move ) -> # set map to new center/ possibly with marker\n      $scope.markers = new Array() if !( $scope.markers? )\n      for marker in $scope.markers\n        marker.setMap( null )\n      $scope.markers = new Array()\n\n      if !( zoom )?\n        zoom = 11\n      \n      # console.log \" zoom #{ zoom }\"\n\n      $scope.map.setZoom( zoom ) if $scope.map?\n\n      if move and $scope.map?\n        $scope.map.setCenter\n          lat: lat\n          lng: lng\n\n\n      if set_markers and google?\n        marker = new (google.maps.Marker)(\n          position: \n            lat: lat\n            lng: lng\n          title: 'Hello World!')\n        $scope.markers.push marker\n\n        marker.setMap $scope.map     \n\n    $scope.find_address = ( address ) -> # event triggered after user has stopped typing for a second. Debounce set on html element\n      geocoder = new google.maps.Geocoder() # geocode address to lat/lng coordinate\n      # console.log \"Address #{ address }\"\n      geocoder.geocode( address: address, ( results, status ) ->\n        \n        # console.log \"results \"\n        console.log results\n        # console.log \"Status #{ JSON.stringify status }\"\n\n        set_map( results[0].geometry.location.lat(), results[0].geometry.location.lng() , true, 15 )\n        \n        \n        \n          \n      )\n\n    $scope.save_address = -> # event triggered when user clicks save address button. \n      console.log $scope.location\n      if $scope.location?\n        $scope.location.id = $scope.location.id\n      # console.log $scope.map.center\n      console.log $scope.location\n      $scope.location.user_id = $rootScope.USER.id\n      $scope.location.org_id = $scope.org.id\n      COMMS.POST( \n        '/location', $scope.location \n      ).then ( ( res ) ->\n        console.log \"Save adddres response\"\n        alertify.success \"Adddres saved\"\n        console.log res\n        # $scope.parsed_data = res\n      ), ( errResponse ) ->\n        console.log \"Save address error\"\n        console.log errResponse\n        alertify.error \"Failed to save location\"\n\n     ###################### BEGIN MAPS ################################\n    uiGmapGoogleMapApi.then (maps) -> # event fired when maps are loaded\n      $scope.map = new (google.maps.Map)(document.getElementById('map-container'),\n        center:\n          lat: 51.9181688\n          lng: -8.5039876\n        zoom: 15)\n      $scope.markers = new Array()\n      set_map( 51.9181688, -8.5039876, true, null, true )\n\n      $scope.map.addListener 'click', ( e ) ->\n        $scope.location.lat = e.latLng.lat()\n        $scope.location.lng = e.latLng.lng()\n        set_map( e.latLng.lat(), e.latLng.lng(), true, $scope.map.zoom, false )\n        \n       \n        \n        \n\n    $scope.$watch 'org', ( old_org, new_org ) -> # watch org for changes and update coords\n      if $scope.org?\n        console.log \"yep\"\n        if $scope.org.org_locations.length > 0\n          $scope.location = $scope.org.org_locations[0]\n          set_map( $scope.location.lat, $scope.location.lng, true, 15, true )       \n \n\n ####################################################################\n #                   Message stuff                                  #\n ####################################################################\n    #initiliase scopes\n    $scope.multi_event = {}\n    $scope.managers_array = new Array()\n    $scope.teams_array = new Array()\n\n    $(document).on 'shown.bs.modal', '#multi_event_modal', ( e )->\n      COMMS.GET(\n        \"/org/teams-and-mangers/#{ $scope.org.id }\"\n      ).then ( ( resp) ->\n        console.log \"Got teams and managers\"\n        console.log resp.data\n        $scope.managers = resp.data.managers\n        # $scope.teams_array = $scope.org.teams.map( ( team ) ->\n        #   team.id\n        # )\n      ), ( errResponse ) ->\n        console.log \"Get teams and managers error\"\n        console.log errResponse\n\n\n    $scope.create_multi_event = ->\n      console.log 'yep'\n      console.log \"teams array #{ JSON.stringify $scope.teams_array }\"\n      console.log \"managers array #{ JSON.stringify $scope.managers_array }\"\n      COMMS.POST(\n        \"/event/create-multi-event\"\n        teams_array: $scope.teams_array\n        managers_array: $scope.managers_array\n        event_details: $scope.multi_event\n      ).then ( ( resp ) ->\n        console.log \"Multi event response\"\n        console.log resp\n        alertify.success \"Created event\"\n      ), ( errResponse ) ->\n        console.log \"Multi event error\"\n        console.log errResponse\n        alertify.error \"Failed to create event\"\n      \n\n\n])\n\nreturn_org = ( orgs, search) ->\n\n  for org in orgs    \n    if parseInt( org.id ) == parseInt( search.id )\n      return org\n\n$('#team_message').modal 'show'"]}