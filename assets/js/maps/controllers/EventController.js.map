{"version":3,"sources":["controllers/EventController.coffee"],"names":[],"mappings":"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","file":"controllers/EventController.js","sourceRoot":"/source/","sourcesContent":["'use strict'\r\n\r\nangular.module('subzapp').controller('EventController', [\r\n  '$scope'\r\n  '$rootScope'\r\n  '$state'\r\n  'COMMS'\r\n  '$stateParams'\r\n  'user'\r\n  'RESOURCES'\r\n  'alertify'\r\n  ( $scope, $rootScope, $state, COMMS, $stateParams, user, RESOURCES, alertify ) ->\r\n    console.log 'Event Controller'\r\n    console.log $stateParams.id\r\n\r\n    $scope.format = \"dd-MMMM-yyyy\"\r\n\r\n    \r\n    user.get_user().then ( (res) ->\r\n      $scope.user = $rootScope.USER\r\n      COMMS.GET(\r\n        \"/event/#{ $stateParams.id }\"\r\n      ).then ( ( resp ) ->\r\n        console.log \"Got event\"\r\n        console.log resp\r\n        alertify.success \"Got event info\"\r\n        $scope.event = resp.data\r\n        $scope.setDate()\r\n      ), ( event_err ) ->\r\n        console.log \"Failed to get event\"\r\n        console.log event_err\r\n        alertify.error \"Failed to get err \"\r\n      \r\n\r\n    ), ( errResponse ) ->\r\n      console.log \"User get error #{ JSON.stringify errResponse }\"\r\n      window.USER = null\r\n      $state.go 'login'\r\n\r\n    $scope.update_event = ->\r\n      console.log \"Help\"\r\n      console.log $scope.event\r\n\r\n      COMMS.POST(\r\n        \"/event/#{ $stateParams.id }\"\r\n        $scope.event\r\n      ).then ( ( res ) ->\r\n        console.log \"Event updated\"\r\n        console.log res\r\n        alertify.success \"Event updated successfully\"\r\n      ), ( errResponse ) ->\r\n        console.log \"Event update error \"\r\n        console.log errResponse\r\n        alertify.error \"Event update error\"\r\n\r\n    $scope.is_open = false\r\n\r\n    $scope.toggle_open = ->\r\n      $scope.is_open = !$scope.is_open\r\n      if $scope.is_open \r\n        COMMS.GET(\r\n          \"/eventresponse/#{ $scope.event.id }/get-attendees-by-event-response\"\r\n        ).then ( ( resp ) ->\r\n          console.log \"Got users\"\r\n          console.log resp\r\n          alertify.success \"Got users\"\r\n          $scope.attendees = resp.data\r\n        ), ( errResponse ) ->\r\n\r\n          console.log \"Failed to get event users\"\r\n          console.log errResponse\r\n          alertify.error \"Failed to get event users\"\r\n\r\n    \r\n    #################### calendar stuff ####################################\r\n    \r\n    $scope.setDate = ->\r\n      $scope.event.start_date = moment( $scope.event.start_date ).format( 'YYYY-MM-DD HH:mm' )\r\n      $scope.event.kick_off_date = moment( $scope.event.kick_off_date ).format( 'YYYY-MM-DD HH:mm' ) if $scope.event.kick_off_date?\r\n      $scope.event.end_date = moment( $scope.event.end_date ).format( 'YYYY-MM-DD HH:mm' )\r\n      \r\n\r\n\r\n    $scope.onTimeSet = ( nd, od ) ->\r\n      $scope.event.start_date = moment( nd ).format( 'YYYY-MM-DD HH:mm' )\r\n      $scope.event.kick_off_date = moment( nd ).add( 1, 'hours' ).format( 'YYYY-MM-DD HH:mm' ) if $scope.event.kick_off_date?\r\n      $scope.event.end_date = moment( nd ).add( 2, 'hours' ).format( 'YYYY-MM-DD HH:mm' )\r\n    \r\n\r\n])\r\n"]}