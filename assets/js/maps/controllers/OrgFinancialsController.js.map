{"version":3,"sources":["controllers/OrgFinancialsController.coffee"],"names":[],"mappings":"AAAA;AAEA,OAAO,CAAC,MAAR,CAAe,SAAf,CAAyB,CAAC,UAA1B,CAAqC,yBAArC,EAAgE;EAC9D,QAD8D,EAE9D,YAF8D,EAG9D,QAH8D,EAI9D,OAJ8D,EAK9D,WAL8D,EAM9D,UAN8D,EAO9D,MAP8D,EAQ9D,OAR8D,EAS9D,QAT8D,EAU9D,SAAE,MAAF,EAAU,UAAV,EAAsB,MAAtB,EAA8B,KAA9B,EAAqC,SAArC,EAAgD,QAAhD,EAA0D,IAA1D,EAAgE,KAAhE,EAAuE,MAAvE;IACE,OAAO,CAAC,GAAR,CAAY,yBAAZ;IACA,MAAM,CAAC,SAAP,GAAmB;IAEnB,MAAM,CAAC,OAAP,GAAiB;IACjB,MAAM,CAAC,OAAO,CAAC,OAAf,GAAyB;IACzB,MAAM,CAAC,OAAO,CAAC,QAAf,GAA0B;IAC1B,MAAM,CAAC,OAAP,GAAiB,CAAE,YAAF,EAAgB,SAAhB;IACjB,MAAM,CAAC,iBAAP,CAAyB,kCAAzB;IAIA,IAAI,CAAC,QAAL,CAAA,CAAe,CAAC,IAAhB,CAAsB,SAAE,GAAF;MACpB,MAAM,CAAC,IAAP,GAAc,UAAU,CAAC;aAEzB,KAAK,CAAC,GAAN,CACE,OAAA,GAAS,UAAU,CAAC,IAAI,CAAC,GAAI,CAAA,CAAA,CAAE,CAAC,EADlC,CAEC,CAAC,IAFF,CAEO,CAAE,SAAE,GAAF;QACP,OAAO,CAAC,GAAR,CAAY,cAAZ;QACA,OAAO,CAAC,GAAR,CAAY,GAAG,CAAC,IAAI,CAAC,GAArB;QACA,MAAM,CAAC,GAAP,GAAa,GAAG,CAAC,IAAI,CAAC;eACtB,QAAQ,CAAC,OAAT,CAAiB,cAAjB;MAJO,CAAF,CAFP,EAOG,SAAE,WAAF;QACD,OAAO,CAAC,GAAR,CAAY,eAAZ;QACA,OAAO,CAAC,GAAG,CAAE;eACb,QAAQ,CAAC,KAAT,CAAe,wBAAf;MAHC,CAPH;IAHoB,CAAtB;IAgBA,MAAM,CAAC,gBAAP,GAA0B,SAAA;MAExB,OAAO,CAAC,GAAR,CAAY,MAAM,CAAC,OAAnB;aACA,MAAM,CAAC,WAAW,CAAC,WAAnB,CAAgC,MAAM,CAAC,OAAvC,CAAgD,CAAC,IAAjD,CAAsD,CAAE,SAAE,cAAF;QACtD,cAAc,CAAC,YAAY,CAAC,MAA5B,GAAqC,MAAM,CAAC,GAAG,CAAC;QAChD,OAAO,CAAC,GAAR,CAAY,iBAAZ;QACA,OAAO,CAAC,GAAR,CAAY,cAAZ;eACA,KAAK,CAAC,IAAN,CACE,OAAA,GAAS,MAAM,CAAC,GAAG,CAAC,EAApB,GAAwB,eAD1B,EAEE,cAAc,CAAC,YAFjB,CAGC,CAAC,IAHF,CAGO,CAAE,SAAE,aAAF;UACP,OAAO,CAAC,GAAR,CAAY,eAAZ;UACA,OAAO,CAAC,GAAR,CAAY,aAAZ;iBACA,QAAQ,CAAC,OAAT,CAAiB,kBAAjB;QAHO,CAAF,CAHP,EAOG,SAAE,WAAF;UACD,OAAO,CAAC,GAAR,CAAY,kBAAZ;UACA,OAAO,CAAC,GAAR,CAAY,WAAZ;iBACA,QAAQ,CAAC,KAAT,CAAe,wBAAf;QAHC,CAPH;MAJsD,CAAF,CAAtD,EAeG,SAAE,WAAF;eACD,OAAO,CAAC,GAAR,CAAY,WAAZ;MADC,CAfH;IAHwB;WAqB1B,MAAM,CAAC,eAAP,GAAyB,SAAA;aACvB,OAAO,CAAC,GAAR,CAAY,MAAM,CAAC,SAAS,CAAC,MAA7B;IADuB;EAjD3B,CAV8D;CAAhE","file":"controllers/OrgFinancialsController.js","sourceRoot":"/source/","sourcesContent":["'use strict'\n\nangular.module('subzapp').controller('OrgFinancialsController', [\n  '$scope'\n  '$rootScope'\n  '$state'\n  '$http'\n  'RESOURCES'\n  'alertify'\n  'user'\n  'COMMS'\n  'stripe'\n  ( $scope, $rootScope, $state, $http, RESOURCES, alertify, user, COMMS, stripe ) ->\n    console.log \"OrgFinancialsController\"\n    $scope.withdrawl = {}\n\n    $scope.account = {}\n    $scope.account.country = \"IE\"\n    $scope.account.currency = \"EUR\"\n    $scope.options = [ \"individual\", \"company\" ]\n    stripe.setPublishableKey 'pk_test_bedFzS7vnmzthkrQolmUjXNn'\n\n    \n\n    user.get_user().then( ( res ) ->\n      $scope.user = $rootScope.USER\n\n      COMMS.GET(\n        \"/org/#{ $rootScope.USER.org[0].id }\"\n      ).then ( ( res ) ->\n        console.log \"Got org info\"\n        console.log res.data.org\n        $scope.org = res.data.org\n        alertify.success \"Got org info\"\n      ), ( errResponse ) ->\n        console.log \"Get org error\"\n        console.log. errResponse\n        alertify.error \"Failed to get org info\"\n    ) # end of get_user\n\n    $scope.add_bank_details = ->\n\n      console.log $scope.account\n      stripe.bankAccount.createToken( $scope.account ).then ( ( stripe_account ) ->\n        stripe_account.bank_account.org_id = $scope.org.id\n        console.log \"Stripe response\"\n        console.log stripe_account\n        COMMS.POST(\n          \"/org/#{ $scope.org.id }/bank-account\"\n          stripe_account.bank_account\n        ).then ( ( account_saved ) ->\n          console.log \"Account saved\"\n          console.log account_saved\n          alertify.success \"Account saved ok\"\n        ), ( account_err ) ->\n          console.log \"Save account err\"\n          console.log account_err\n          alertify.error \"Failed to save account\"\n      ), ( errResponse ) ->\n        console.log errResponse\n\n    $scope.withdraw_tokens = ->\n      console.log $scope.withdrawl.amount\n\n\n])"]}