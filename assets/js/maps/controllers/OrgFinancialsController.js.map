{"version":3,"sources":["controllers/OrgFinancialsController.coffee"],"names":[],"mappings":"AAAA;AAEA,OAAO,CAAC,MAAR,CAAe,SAAf,CAAyB,CAAC,UAA1B,CAAqC,yBAArC,EAAgE;EAC9D,QAD8D,EAE9D,YAF8D,EAG9D,QAH8D,EAI9D,OAJ8D,EAK9D,WAL8D,EAM9D,WAN8D,EAO9D,UAP8D,EAQ9D,MAR8D,EAS9D,OAT8D,EAU9D,SAAE,MAAF,EAAU,UAAV,EAAsB,MAAtB,EAA8B,KAA9B,EAAqC,SAArC,EAAgD,SAAhD,EAA2D,QAA3D,EAAqE,IAArE,EAA2E,KAA3E;AACE,QAAA;IAAA,OAAO,CAAC,GAAR,CAAY,yBAAZ;IAEA,qBAAA,GAAwB,SAAA;MACtB,IAAG,+BAAH;QACE,OAAO,CAAC,GAAR,CAAY,SAAS,CAAC,MAAV,CAAA,CAAkB,CAAC,IAA/B;eACA,KAAK,CAAC,IAAN,CACE,WAAA,GAAa,MAAM,CAAC,GAAG,CAAC,EAAxB,GAA4B,sBAD9B,EAEE;UAAA,SAAA,EAAW,SAAS,CAAC,MAAV,CAAA,CAAkB,CAAC,IAA9B;SAFF,CAGC,CAAC,IAHF,CAGO,CAAE,SAAE,GAAF;AACP,cAAA;UAAA,OAAO,CAAC,GAAR,CAAY,sBAAZ;UAGA,OAAA,GAAU,IAAI,CAAC,KAAL,CAAW,GAAG,CAAC,IAAI,CAAC,IAApB;UACV,OAAO,CAAC,GAAR,CAAY,OAAO,CAAC,iBAApB;UACA,IAAG,iCAAH;mBACE,QAAQ,CAAC,KAAT,CAAe,OAAO,CAAC,iBAAvB,EADF;WAAA,MAAA;mBAGE,QAAQ,CAAC,OAAT,CAAiB,sBAAjB,EAHF;;QANO,CAAF,CAHP,EAcG,SAAE,WAAF;UAED,OAAO,CAAC,GAAR,CAAY,+BAAZ;UACA,QAAQ,CAAC,KAAT,CAAe,+BAAf;iBACA,OAAO,CAAC,GAAR,CAAY,WAAZ;QAJC,CAdH,EAFF;;IADsB;WAwBxB,IAAI,CAAC,QAAL,CAAA,CAAe,CAAC,IAAhB,CAAsB,SAAE,GAAF;MACpB,MAAM,CAAC,IAAP,GAAc,UAAU,CAAC;aAEzB,KAAK,CAAC,GAAN,CACE,OAAA,GAAS,MAAM,CAAC,IAAI,CAAC,GAAI,CAAA,CAAA,CAAE,CAAC,EAD9B,CAEC,CAAC,IAFF,CAEO,CAAE,SAAE,GAAF;QACP,OAAO,CAAC,GAAR,CAAY,cAAZ;QACA,OAAO,CAAC,GAAR,CAAY,GAAG,CAAC,IAAI,CAAC,GAArB;QACA,MAAM,CAAC,GAAP,GAAa,GAAG,CAAC,IAAI,CAAC;QACtB,QAAQ,CAAC,OAAT,CAAiB,cAAjB;eACA,qBAAA,CAAA;MALO,CAAF,CAFP,EAQG,SAAE,WAAF;QACD,OAAO,CAAC,GAAR,CAAY,eAAZ;QACA,OAAO,CAAC,GAAG,CAAE;eACb,QAAQ,CAAC,KAAT,CAAe,wBAAf;MAHC,CARH;IAHoB,CAAtB;EA3BF,CAV8D;CAAhE","file":"controllers/OrgFinancialsController.js","sourceRoot":"/source/","sourcesContent":["'use strict'\n\nangular.module('subzapp').controller('OrgFinancialsController', [\n  '$scope'\n  '$rootScope'\n  '$state'\n  '$http'\n  'RESOURCES'\n  '$location'\n  'alertify'\n  'user'\n  'COMMS'\n  ( $scope, $rootScope, $state, $http, RESOURCES, $location, alertify, user, COMMS ) ->\n    console.log \"OrgFinancialsController\"\n\n    check_for_stripe_code = ->\n      if $location.search().code?\n        console.log $location.search().code\n        COMMS.POST(\n          \"/payment/#{ $scope.org.id }/authenticate-stripe\"\n          auth_code: $location.search().code\n        ).then ( ( res ) ->\n          console.log \"Authenticated stripe\"\n          \n          \n          message = JSON.parse res.data.body\n          console.log message.error_description\n          if message.error_description?\n            alertify.error message.error_description\n          else\n            alertify.success \"Authenticated stripe\"\n\n        ), ( errResponse ) ->\n\n          console.log \"Failed to authenticate stripe\"\n          alertify.error \"Failed to authenticate stripe\"\n          console.log errResponse\n\n\n    user.get_user().then( ( res ) ->\n      $scope.user = $rootScope.USER\n\n      COMMS.GET(\n        \"/org/#{ $scope.user.org[0].id }\"\n      ).then ( ( res ) ->\n        console.log \"Got org info\"\n        console.log res.data.org\n        $scope.org = res.data.org\n        alertify.success \"Got org info\"\n        check_for_stripe_code()\n      ), ( errResponse ) ->\n        console.log \"Get org error\"\n        console.log. errResponse\n        alertify.error \"Failed to get org info\"\n    ) # end of get_user\n\n\n\n])"]}