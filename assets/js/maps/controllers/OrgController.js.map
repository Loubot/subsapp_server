{"version":3,"sources":["controllers/OrgController.coffee"],"names":[],"mappings":"AAAA;AAEA,OAAO,CAAC,MAAR,CAAe,SAAf,CAAyB,CAAC,UAA1B,CAAqC,eAArC,EAAsD;EACpD,QADoD,EAEpD,QAFoD,EAGpD,OAHoD,EAIpD,SAJoD,EAKpD,WALoD,EAMpD,MANoD,EAOpD,WAPoD,EAQpD,UARoD,EASpD,SAAE,MAAF,EAAU,MAAV,EAAkB,KAAlB,EAAyB,OAAzB,EAAkC,SAAlC,EAA6C,IAA7C,EAAmD,SAAnD,EAA8D,QAA9D;AACE,QAAA;IAAA,UAAA,GAAa,MAAM,CAAC,YAAY,CAAC,OAApB,CAA4B,YAA5B;IAEb,QAAA,GAAW,SAAA;aACT,KAAK,CAAC,GAAN,CACE,OADF,CAEC,CAAC,IAFF,CAEQ,SAAE,IAAF;QACN,OAAO,CAAC,GAAR,CAAY,WAAZ;QACA,OAAO,CAAC,GAAR,CAAY,IAAI,CAAC,IAAjB;eACA,MAAM,CAAC,IAAP,GAAc,IAAI,CAAC;MAHb,CAFR,CAMC,CAAC,OAAD,CAND,CAMS,SAAE,GAAF;QACP,OAAO,CAAC,GAAR,CAAY,gBAAZ;QACA,OAAO,CAAC,GAAR,CAAY,GAAZ;eACA,MAAM,CAAC,EAAP,CAAU,OAAV;MAHO,CANT;IADS;IAcX,OAAO,CAAC,GAAR,CAAY,gBAAZ;IACA,IAAG,CAAC,CAAC,mBAAD,CAAJ;MACE,IAAI,CAAC,QAAL,CAAA,CAAe,CAAC,IAAhB,CAAqB,CAAE,SAAC,GAAD;eACrB,QAAA,CAAA;MADqB,CAAF,CAArB,EAGG,SAAE,WAAF;QACD,OAAO,CAAC,GAAR,CAAY,iBAAA,GAAiB,CAAE,IAAI,CAAC,SAAL,CAAe,WAAf,CAAF,CAA7B;QACA,MAAM,CAAC,IAAP,GAAc;eACd,MAAM,CAAC,EAAP,CAAU,OAAV;MAHC,CAHH,EADF;KAAA,MAAA;MASE,QAAA,CAAA;MACA,OAAO,CAAC,GAAR,CAAY,sBAAZ,EAVF;;IAaA,MAAM,CAAC,YAAP,GAAsB,SAAE,EAAF;MACpB,OAAO,CAAC,GAAR,CAAY,eAAA,GAAiB,MAAM,CAAC,GAApC;MACA,OAAO,CAAC,GAAR,CAAY,MAAM,CAAC,GAAnB;aACA,KAAK,CAAC,GAAN,CACE,eAAA,GAAiB,MAAM,CAAC,GAD1B,CAEC,CAAC,IAFF,CAEO,CAAE,SAAE,GAAF;QAEP,OAAO,CAAC,GAAR,CAAY,kBAAZ;QACA,OAAO,CAAC,GAAR,CAAY,GAAG,CAAC,IAAhB;eACA,MAAM,CAAC,KAAP,GAAe,GAAG,CAAC,IAAI,CAAC;MAJjB,CAAF,CAFP,EAOG,SAAE,WAAF;QAED,OAAO,CAAC,GAAR,CAAY,wBAAZ;QACA,OAAO,CAAC,GAAR,CAAY,WAAZ;QACA,IAAG,WAAW,CAAC,MAAZ,KAAsB,GAAzB;UACE,QAAQ,CAAC,KAAT,CAAe,0CAAf;iBACA,MAAM,CAAC,EAAP,CAAU,OAAV,EAFF;;MAJC,CAPH;IAHoB;WAmBtB,MAAM,CAAC,WAAP,GAAqB,SAAA;MACnB,OAAO,CAAC,GAAR,CAAY,KAAZ;aACA,KAAK,CAAC,IAAN,CACE,sBADF,EAEE;QAAA,MAAA,EAAQ,MAAM,CAAC,GAAf;OAFF,CAGC,CAAC,IAHF,CAGO,CAAE,SAAE,GAAF;QACP,OAAO,CAAC,GAAR,CAAY,sBAAZ;QACA,OAAO,CAAC,GAAR,CAAY,GAAZ;eACA,MAAM,CAAC,WAAP,GAAqB;MAHd,CAAF,CAHP,EAOG,SAAE,WAAF;QACD,OAAO,CAAC,GAAR,CAAY,mBAAZ;eACA,OAAO,CAAC,GAAR,CAAY,WAAZ;MAFC,CAPH;IAFmB;EAlDvB,CAToD;CAAtD","file":"controllers/OrgController.js","sourceRoot":"/source/","sourcesContent":["'use strict'\n\nangular.module('subzapp').controller('OrgController', [\n  '$scope'\n  '$state'\n  'COMMS'\n  '$window'\n  '$location'\n  'user'\n  'RESOURCES'\n  'alertify'\n  ( $scope, $state, COMMS, $window, $location, user, RESOURCES, alertify ) ->\n    user_token = window.localStorage.getItem 'user_token'\n\n    get_orgs = ->\n      COMMS.GET(\n        '/orgs'\n      ).then( ( orgs ) ->\n        console.log \"Got orgs \"\n        console.log orgs.data\n        $scope.orgs = orgs.data\n      ).catch( ( err ) ->\n        console.log \"Got orgs error\"\n        console.log err\n        $state.go 'login'\n      )\n        \n\n    console.log 'Org Controller'\n    if !(window.USER?)\n      user.get_user().then ( (res) ->\n        get_orgs()\n\n      ), ( errResponse ) ->\n        console.log \"User get error #{ JSON.stringify errResponse }\"\n        window.USER = null\n        $state.go 'login'\n    else\n      get_orgs()\n      console.log \"USER already defined\"\n      \n      \n    $scope.get_org_info = ( id ) ->\n      console.log \"/org/s3-info/#{ $scope.org }\"\n      console.log $scope.org\n      COMMS.GET(\n        \"/org/s3-info/#{ $scope.org }\"\n      ).then ( ( res ) ->\n        \n        console.log \"s3_info response\"\n        console.log res.data\n        $scope.files = res.data.Contents\n      ), ( errResponse ) ->\n        \n        console.log \"s3_info error response\"\n        console.log errResponse\n        if errResponse.status == 401\n          alertify.error \"You are not authorised to view this page\"\n          $state.go 'login'\n      \n\n    $scope.parse_users = ->\n      console.log 'yep'\n      COMMS.POST(\n        \"/file/parse-players/\"\n        org_id: $scope.org\n      ).then ( ( res ) ->\n        console.log \"parse users response\"\n        console.log res\n        $scope.parsed_data = res\n      ), ( errResponse ) ->\n        console.log \"Parse users error\"\n        console.log errResponse\n\n])\n\n\n"]}