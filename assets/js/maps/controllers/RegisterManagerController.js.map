{"version":3,"sources":["controllers/RegisterManagerController.coffee"],"names":[],"mappings":"AAAA;AAEA,OAAO,CAAC,MAAR,CAAe,SAAf,CAAyB,CAAC,UAA1B,CAAqC,2BAArC,EAAkE;EAChE,QADgE,EAEhE,QAFgE,EAGhE,OAHgE,EAIhE,SAJgE,EAKhE,UALgE,EAMhE,WANgE,EAOhE,WAPgE,EAQhE,SAAE,MAAF,EAAU,MAAV,EAAkB,KAAlB,EAAyB,OAAzB,EAAkC,QAAlC,EAA4C,SAA5C,EAAuD,SAAvD;IACE,OAAO,CAAC,GAAR,CAAY,6BAAZ;IACA,MAAM,CAAC,0BAAP,GAAoC,SAAS,CAAC,MAAV,CAAA;IAEpC,OAAO,CAAC,GAAR,CAAY,SAAS,CAAC,MAAV,CAAA,CAAZ;IAEA,KAAA,CACE;MAAA,MAAA,EAAQ,KAAR;MACA,GAAA,EAAS,SAAS,CAAC,MAAZ,GAAoB,aAD3B;MAEA,OAAA,EAAS;QACG,cAAA,EAAgB,kBADnB;OAFT;MAKA,MAAA,EACE;QAAA,SAAA,EAAW,SAAS,CAAC,MAAV,CAAA,CAAkB,CAAC,EAA9B;OANF;KADF,CAQC,CAAC,IARF,CAQO,CAAE,SAAE,QAAF;MACP,OAAO,CAAC,GAAR,CAAY,qBAAZ;MACA,OAAO,CAAC,GAAR,CAAY,QAAQ,CAAC,IAArB;MACA,MAAM,CAAC,0BAAP,GAAoC,QAAQ,CAAC;MAC7C,MAAM,CAAC,0BAA0B,CAAC,aAAlC,GAAkD,QAAQ,CAAC,IAAI,CAAC;aAChE,MAAM,CAAC,OAAP,GAAiB,QAAQ,CAAC,IAAI,CAAC;IALxB,CAAF,CARP,EAeG,SAAE,WAAF;MACD,OAAO,CAAC,GAAR,CAAY,kBAAZ;aACA,OAAO,CAAC,GAAR,CAAY,WAAZ;IAFC,CAfH;WAmBA,MAAM,CAAC,uBAAP,GAAiC,SAAA;MAC/B,OAAO,CAAC,GAAR,CAAY,IAAI,CAAC,SAAL,CAAe,MAAM,CAAC,0BAAtB,CAAZ;MACA,MAAM,CAAC,0BAA0B,CAAC,UAAlC,GAA+C;MAC/C,MAAM,CAAC,0BAA0B,CAAC,OAAlC,GAA4C,MAAM,CAAC;MACnD,MAAM,CAAC,0BAA0B,CAAC,KAAlC,GAA0C,MAAM,CAAC,0BAA0B,CAAC;MAC5E,OAAO,MAAM,CAAC,0BAA0B,CAAC;MAEzC,OAAO,CAAC,GAAR,CAAY,MAAM,CAAC,0BAAnB;aACA,KAAA,CACE;QAAA,MAAA,EAAQ,MAAR;QACA,GAAA,EAAS,SAAS,CAAC,MAAZ,GAAoB,2BAD3B;QAEA,OAAA,EAAS;UACC,cAAA,EAAgB,kBADjB;SAFT;QAKA,IAAA,EAAM,MAAM,CAAC,0BALb;OADF,CAOC,CAAC,IAPF,CAOO,CAAE,SAAC,QAAD;QACP,OAAO,CAAC,GAAR,CAAY,2BAAZ;QACA,OAAO,CAAC,GAAR,CAAY,QAAZ;QACA,MAAM,CAAC,YAAY,CAAC,OAApB,CAA4B,YAA5B,EAA0C,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,KAA7D;QAEA,MAAM,CAAC,YAAY,CAAC,OAApB,CAA4B,SAA5B,EAAuC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAA/D;eACA,MAAM,CAAC,EAAP,CAAU,MAAV;MANO,CAAF,CAPP,EAcG,SAAE,WAAF;QACD,OAAO,CAAC,GAAR,CAAY,sBAAZ;QACA,UAAA,CAAW,CAAE,SAAA;iBACX,MAAM,CAAC,EAAP,CAAU,OAAV;QADW,CAAF,CAAX,EAEG,IAFH;eAGA,OAAO,CAAC,GAAR,CAAY,WAAZ;MALC,CAdH;IAR+B;EAzBnC,CARgE;CAAlE","file":"controllers/RegisterManagerController.js","sourceRoot":"/source/","sourcesContent":["'use strict'\n\nangular.module('subzapp').controller('RegisterManagerController', [\n  '$scope'\n  '$state'\n  '$http'\n  '$window'\n  'alertify'\n  '$location'\n  'RESOURCES'\n  ( $scope, $state, $http, $window, alertify, $location, RESOURCES ) ->\n    console.log 'Register Manager Controller'\n    $scope.register_manager_form_data = $location.search()\n\n    console.log $location.search()\n\n    $http(\n      method: 'GET'\n      url: \"#{ RESOURCES.DOMAIN }/get-invite\"\n      headers: { \n                  'Content-Type': 'application/json'\n                }\n      params:\n        invite_id: $location.search().id\n    ).then ( ( response ) ->\n      console.log \"Get invite response\"\n      console.log response.data\n      $scope.register_manager_form_data = response.data\n      $scope.register_manager_form_data.invited_email = response.data.invited_email\n      $scope.team_id = response.data.team_id\n\n    ), ( errResponse ) ->\n      console.log \"Get invite error\"\n      console.log errResponse\n\n    $scope.register_manager_submit = ->\n      console.log JSON.stringify $scope.register_manager_form_data\n      $scope.register_manager_form_data.team_admin = true\n      $scope.register_manager_form_data.team_id = $scope.team_id\n      $scope.register_manager_form_data.email = $scope.register_manager_form_data.invited_email\n      delete $scope.register_manager_form_data.invited_email\n      \n      console.log $scope.register_manager_form_data\n      $http(\n        method: 'POST'\n        url: \"#{ RESOURCES.DOMAIN }/auth/team_manager_signup\"\n        headers: { \n                  'Content-Type': 'application/json'\n                  }\n        data: $scope.register_manager_form_data\n      ).then ( (response) ->\n        console.log \"Registration successfull \"\n        console.log response\n        window.localStorage.setItem 'user_token', response.data.data.token\n        # console.log \"user_token \" + window.localStorage.getItem 'user_token'\n        window.localStorage.setItem 'user_id', response.data.data.user.id\n        $state.go 'user'\n      ), ( errResponse ) ->\n        console.log \"Registration failed \"\n        setTimeout ( ->\n          $state.go 'login' \n        ), 5000\n        console.log errResponse\n            \n       \n        # message.error errResponse.data.invalidAttributes.email[0].message\n       \n        \n])"]}