{"version":3,"sources":["controllers/TeamController.coffee"],"names":[],"mappings":"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","file":"controllers/TeamController.js","sourceRoot":"/source/","sourcesContent":["'use strict'\r\n\r\nangular.module('subzapp').controller('TeamController', [\r\n  '$scope'\r\n  '$state'\r\n  '$http'\r\n  '$window'\r\n  '$location'\r\n  'user'\r\n  'alertify'\r\n  'RESOURCES'\r\n  'Upload'\r\n  '$filter'\r\n  'usSpinnerService'\r\n  ( $scope, $state, $http, $window, $location, user, alertify, RESOURCES, Upload, $filter, usSpinnerService ) ->    \r\n    console.log 'Team Controller'\r\n    user_token = window.localStorage.getItem 'user_token'\r\n\r\n    get_team_info = ->\r\n      if $scope.user.club_admin\r\n        $http(\r\n          method: 'GET'\r\n          url: \"#{ RESOURCES.DOMAIN }/team/get-team-info/#{ window.localStorage.getItem 'team_id' }\"\r\n          headers: { \r\n                    'Authorization': \"JWT #{ user_token }\", \"Content-Type\": \"application/json\"\r\n                    }\r\n          \r\n        ).then ( (res) ->\r\n           console.log \"get_team_info response club admin\"\r\n           console.log res\r\n           $scope.team = res.data.team\r\n           $scope.files = res.data.bucket_info.Contents\r\n           $scope.org_members = res.data.org.org_members\r\n           $scope.team.eligible_date = $filter('date')($scope.team.eligible_date, 'yyyy-MM-dd')\r\n           \r\n          \r\n        ), ( errResponse ) ->\r\n          console.log \"get_team_info error\"\r\n          console.log errResponse\r\n      else\r\n        $http(\r\n          method: 'GET'\r\n          url: \"#{ RESOURCES.DOMAIN }/team/#{ window.localStorage.getItem 'team_id' }\"\r\n          headers: { \r\n                    'Authorization': \"JWT #{ user_token }\", \"Content-Type\": \"application/json\"\r\n                    }\r\n\r\n        ).then ( (res) ->\r\n           console.log \"Get team info response\"\r\n           console.log res.data\r\n           $scope.team = res.data\r\n           \r\n        ), ( errResponse ) ->\r\n          console.log \"Get team info error #{ JSON.stringify errResponse }\"\r\n          $state.go 'login'\r\n\r\n    if !(window.USER?)\r\n      user.get_user().then ( (res) ->\r\n        # console.log \"User set to #{ JSON.stringify res }\"\r\n        # console.log \"TeamController teams #{ JSON.stringify window.USER }\"\r\n        $scope.user = window.USER\r\n        $scope.org = window.USER.orgs[0]\r\n        $scope.teams = window.USER.teams\r\n        return_team( USER.teams, $location.search().id )\r\n        $scope.show_upload = window.USER.club_admin\r\n        get_team_info() if $scope.user.club_admin\r\n      ), ( errResponse ) ->\r\n        window.USER = null\r\n        # $state.go 'login'\r\n    else\r\n      console.log \"USER already defined\"\r\n      $scope.user = window.USER\r\n      $scope.org = window.USER.orgs[0]\r\n      $scope.teams = window.USER.teams\r\n      $scope.user = window.USER\r\n      get_team_info() if $scope.user.club_admin\r\n  \r\n      \r\n    $scope.create_event = ->\r\n      $scope.create_event_data.team_id = $scope.team.id\r\n      console.log $scope.create_event_data\r\n      $http(\r\n        method: 'POST'\r\n        url: \"#{ RESOURCES.DOMAIN }/create-event\"\r\n        headers: { \r\n                  'Authorization': \"JWT #{ user_token }\", \"Content-Type\": \"application/json\",\r\n                  'Content-Type': 'application/json'\r\n                  }\r\n        data: $scope.create_event_data\r\n      ).then ( (res) ->\r\n        # console.log \"Create event response\"\r\n        alertify.success(\"Event created\")\r\n        console.log res.data\r\n        $scope.events = res.data\r\n      ), ( errResponse ) ->\r\n        console.log \"Create event error\"\r\n        alertify.error \"Create event failed\"\r\n        console.log errResponse\r\n\r\n\r\n    # upload file\r\n\r\n    $scope.submit = ->\r\n      \r\n      $scope.upload $scope.file\r\n\r\n    $scope.upload = (file) ->\r\n      console.log \"Upload\"\r\n      console.log file\r\n      console.log JSON.stringify $scope.team.name\r\n      Upload.upload(\r\n        method: 'post'\r\n        url: '/file/upload'\r\n        data:\r\n          org_id: $scope.team.main_org.id\r\n          team_id: $scope.team.id\r\n          team_name: $scope.team.name\r\n        file: file        \r\n          \r\n      ).then ((resp) ->\r\n        console.log 'Success ' + JSON.stringify resp + 'uploaded. Response: ' + JSON.stringify resp.data\r\n        console.log resp\r\n        $scope.files = resp.data.bucket_info.Contents\r\n        alertify.success \"File uploaded ok\"\r\n        return\r\n      ), ((resp) ->\r\n        console.log 'Error status: ' + resp.status\r\n        alertify.error \"File failed to upload\"\r\n        console.log resp\r\n\r\n        alertify.error \"File upload failed. Status: #{ resp.status }\"\r\n        return\r\n      ), (evt) ->\r\n        progressPercentage = parseInt(100.0 * evt.loaded / evt.total)\r\n        console.log 'progress: ' + progressPercentage + '% ' + evt.config.data\r\n\r\n    $scope.get_players_by_year = ( id ) ->\r\n      console.log \"Find by date\"\r\n      $http(\r\n        method: 'GET'\r\n        url: \"#{ RESOURCES.DOMAIN }/team/get-players-by-year/#{ $scope.team.id }\"\r\n        headers: { \r\n                  'Authorization': \"JWT #{ user_token }\", \"Content-Type\": \"application/json\"\r\n                  }\r\n        # params:\r\n        #   team_id: id\r\n      ).then ( (res) ->\r\n         console.log \"Playsers by age response\"\r\n         console.log res\r\n         \r\n      ), ( errResponse ) ->\r\n        console.log \"DOwnload error #{ JSON.stringify errResponse }\"\r\n\r\n  \r\n    $scope.download = ->\r\n      $http(\r\n        method: 'GET'\r\n        url: \"#{ RESOURCES.DOMAIN }/user/download-file\"\r\n        headers: { \r\n                  'Authorization': \"JWT #{ user_token }\", \"Content-Type\": \"application/json\"\r\n                  }\r\n        \r\n      ).then ( (res) ->\r\n         console.log \"Download response\"\r\n         console.log res\r\n         \r\n      ), ( errResponse ) ->\r\n        console.log \"DOwnload error #{ JSON.stringify errResponse }\"\r\n\r\n    $scope.update_members = ->\r\n      console.log \"team id #{ $scope.team.id }\"\r\n      $http(\r\n        method: 'POST'\r\n        url: \"#{ RESOURCES.DOMAIN }/team/update-members/#{ $scope.team.id }\"\r\n        headers: { \r\n                  'Authorization': \"JWT #{ user_token }\", \"Content-Type\": \"application/json\",\r\n                  'Content-Type': 'application/json'\r\n                  }\r\n\r\n        data:\r\n          team_members: $scope.team_members_array\r\n      ).then ( ( res ) ->\r\n        console.log \"Update team members\"\r\n        console.log res\r\n        $('#select_player_modal').modal('hide')\r\n        alertify.success \"Team members updated successfully\"\r\n      ), ( errResponse ) ->\r\n        console.log \"Update team members error \"\r\n        console.log errResponse\r\n        alertify.error \"Failed to add team members\"\r\n\r\n    $scope.update_eligible_date = () ->\r\n      console.log 'yep'\r\n      console.log $scope.team.eligible_date\r\n      $http(\r\n        method: 'POST'\r\n        url: \"#{ RESOURCES.DOMAIN }/team/update/#{ $scope.team.id }\"\r\n        headers: { \r\n                  'Authorization': \"JWT #{ user_token }\", \"Content-Type\": \"application/json\",\r\n                  'Content-Type': 'application/json'\r\n                  }\r\n        data:\r\n          eligible_date: $scope.team.eligible_date\r\n      ).then ( ( res ) ->\r\n        console.log \"Update team date\"\r\n        console.log res.data[0].eligible_date\r\n        $scope.team.eligible_date = $filter('date')(res.data[0].eligible_date, \"yyyy-MM-dd\" )\r\n        alertify.success \"Eligible date updated\"\r\n      ), ( errResponse ) ->\r\n        console.log \"Update date error \"\r\n        console.log errResponse\r\n        alertify.error \"Update failed\"\r\n\r\n    $('#select_player_modal').on 'shown.bs.modal', (e) ->\r\n      usSpinnerService.spin('spinner-1')\r\n      $http(\r\n        method: 'GET'\r\n        url: \"#{ RESOURCES.DOMAIN }/org/get-org/#{ $scope.team.main_org.id }\"\r\n        headers: { \r\n                  'Authorization': \"JWT #{ user_token }\", \"Content-Type\": \"application/json\",\r\n                  'Content-Type': 'application/json'\r\n                  }\r\n       \r\n      ).then ( ( res ) ->\r\n        console.log \"Get org info \"\r\n        console.log res.data\r\n        $scope.org_members = res.data.org_members\r\n        $scope.team_members_array = $scope.team_members_array = $scope.team.team_members.map( ( member ) ->\r\n            member.id )\r\n        usSpinnerService.stop('spinner-1')\r\n        alertify.success \"Got players info\"\r\n      ), ( errResponse ) ->\r\n        console.log \"Get org info error \"\r\n        usSpinnerService.stop('spinner-1')\r\n        console.log errResponse\r\n        alertify.error \"Couldn't get players info\"\r\n    \r\n])\r\n\r\nreturn_team = ( teams, id ) ->\r\n  team = (team for team in teams when team.id is parseInt( id ))\r\n  console.log \"Team #{ JSON.stringify team }\"\r\n  return team\r\n\r\n #  $scope.members = res.data.team.team_members\r\n # $scope.events = res.data.team.events\r\n # $scope.files = res.data.bucket_info.Contents\r\n\r\n\r\n"]}