{"version":3,"sources":["controllers/LoginController.coffee"],"names":[],"mappings":"AAAA;AAEA,OAAO,CAAC,MAAR,CAAe,SAAf,CAAyB,CAAC,UAA1B,CAAqC,iBAArC,EAAwD;EACtD,QADsD,EAEtD,QAFsD,EAGtD,OAHsD,EAItD,SAJsD,EAKtD,WALsD,EAMtD,UANsD,EAQtD,SAAE,MAAF,EAAU,MAAV,EAAkB,KAAlB,EAAyB,OAAzB,EAAkC,SAAlC,EAA6C,QAA7C;IACE,OAAO,CAAC,GAAR,CAAY,kBAAZ;IAEA,MAAM,CAAC,YAAP,GAAsB,SAAA;aACpB,KAAA,CACE;QAAA,MAAA,EAAQ,MAAR;QACA,GAAA,EAAS,SAAS,CAAC,MAAZ,GAAoB,cAD3B;QAEA,OAAA,EAAS;UACC,cAAA,EAAgB,kBADjB;SAFT;QAKA,IAAA,EAAM,MAAM,CAAC,eALb;OADF,CAOC,CAAC,IAPF,CAOO,CAAE,SAAC,QAAD;QACP,OAAO,CAAC,GAAR,CAAY,UAAA,GAAY,QAAQ,CAAC,IAAI,CAAC,IAAtC;QACA,OAAO,CAAC,GAAR,CAAY,QAAZ;QACA,MAAM,CAAC,IAAP,GAAc,QAAQ,CAAC,IAAI,CAAC;QAC5B,MAAM,CAAC,YAAY,CAAC,OAApB,CAA4B,YAA5B,EAA0C,QAAQ,CAAC,IAAI,CAAC,KAAxD;QACA,MAAM,CAAC,YAAY,CAAC,OAApB,CAA4B,SAA5B,EAAuC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAA1D;QAGA,IAAG,MAAM,CAAC,IAAI,CAAC,UAAf;UACE,OAAO,CAAC,GAAR,CAAY,YAAZ;iBACA,MAAM,CAAC,EAAP,CAAU,WAAV,EAFF;SAAA,MAAA;UAIE,OAAO,CAAC,GAAR,CAAY,cAAZ;iBACA,MAAM,CAAC,EAAP,CAAU,mBAAV,EALF;;MARO,CAAF,CAPP,EAqBG,SAAE,WAAF;QACD,OAAO,CAAC,GAAR,CAAY,iBAAA,GAAiB,CAAE,IAAI,CAAC,SAAL,CAAe,WAAW,CAAC,IAA3B,CAAF,CAA7B;QACA,MAAM,CAAC,IAAP,GAAc;eACd,QAAQ,CAAC,KAAT,CAAgB,WAAW,CAAC,IAAI,CAAC,OAAjC;MAHC,CArBH;IADoB;WA8CtB,MAAM,CAAC,WAAP,GAAqB;MACnB,KAAA,EAAQ,EADW;MAEnB,QAAA,EAAW,EAFQ;;EAjDvB,CARsD;CAAxD","file":"controllers/LoginController.js","sourceRoot":"/source/","sourcesContent":["'use strict'\r\n\r\nangular.module('subzapp').controller('LoginController', [\r\n  '$scope'\r\n  '$state'\r\n  '$http'\r\n  '$window'\r\n  'RESOURCES'\r\n  'alertify'\r\n  # 'AuthService'\r\n  ( $scope, $state, $http, $window, RESOURCES, alertify ) ->\r\n    console.log 'Login Controller'\r\n    \r\n    $scope.login_submit = ->\r\n      $http(\r\n        method: 'POST'\r\n        url: \"#{ RESOURCES.DOMAIN }/auth/signin\"\r\n        headers: {\r\n                  'Content-Type': 'application/json'\r\n                  }\r\n        data: $scope.login_form_data\r\n      ).then ( (response) ->\r\n        console.log \"User id #{ response.data.user }\"\r\n        console.log response\r\n        $scope.user = response.data.user\r\n        window.localStorage.setItem 'user_token', response.data.token\r\n        window.localStorage.setItem 'user_id', response.data.user.id\r\n        # console.log \"Success response token #{ JSON.stringify response.data.token }\"\r\n        # $state.go 'org'\r\n        if $scope.user.club_admin\r\n          console.log 'club_admin'\r\n          $state.go 'org_admin'\r\n        else\r\n          console.log 'team_manager'\r\n          $state.go 'team_manager_home'\r\n      ), ( errResponse ) ->\r\n        console.log \"Error response #{ JSON.stringify errResponse.data }\"\r\n        window.USER = null\r\n        alertify.error( errResponse.data.message )\r\n        # $scope.errorMessage = errResponse\r\n        \r\n\r\n\r\n\r\n      # $http.post(\"#{ RESOURCES.DOMAIN }/auth/signin\", $scope.login_form_data).success( (data) ->\r\n      #   console.log \"returned #{ JSON.stringify data }\"\r\n      #   window.localStorage.setItem 'logged_in_user', JSON.stringify data\r\n      #   $scope.login_form_data = {}\r\n      #   $scope.returned = data\r\n\r\n      #   $state.go 'user'\r\n\r\n      # ).fail( (error) ->\r\n      #   console.log \"new error\"\r\n      # ).error (err) ->\r\n      #   $('.login_error').show 'slide', { direction: 'right' }, 1000\r\n      #   $scope.errorMessage = err\r\n      #   console.log \"error!!!!!\" + JSON.stringify err\r\n\r\n    $scope.credentials = {\r\n      email : ''\r\n      password : ''\r\n    }\r\n\r\n    # $scope.login = ->\r\n    #   AuthService.login $scope.credentials, (response) ->\r\n    #     console.log response\r\n\r\n])\r\n"]}