{"version":3,"sources":["app.coffee"],"names":[],"mappings":"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","file":"app.js","sourceRoot":"/source/","sourcesContent":["#Global variable for logged in user\r\n\r\nwindow.USER = null\r\n\r\n# See user service\r\n\r\n'use strict'\r\n\r\nangular.module('subzapp', [\r\n    'ngAnimate'\r\n    'ui.router'\r\n    'ngRoute'\r\n    'ui.bootstrap.datetimepicker'\r\n    \"ngAlertify\"\r\n    'ngFileUpload'\r\n    \"checklist-model\"\r\n    'angularSpinner'\r\n    'uiGmapgoogle-maps'\r\n])\r\n\r\nangular.module('subzapp').config (uiGmapGoogleMapApiProvider) ->\r\n  uiGmapGoogleMapApiProvider.configure\r\n    key: 'AIzaSyCwEGjP02TnzKzlAHNeLD8M_7cMw0fPATM'\r\n    v: '3.23'\r\n    libraries: 'weather,geometry,visualization,places'\r\n  \r\n\r\nangular.module('subzapp').constant('API', 'api/v1/')\r\n  \r\n#routes, using angular-ui-router\r\nangular.module('subzapp').config ($stateProvider, $urlRouterProvider) ->\r\n\r\n    $urlRouterProvider.otherwise \"/\"\r\n\r\n    $stateProvider.state \"user\",\r\n      url : \"/user\"\r\n      templateUrl : 'angular_app/views/user/user.html'\r\n      controller : \"UserController\"\r\n\r\n    $stateProvider.state \"edit-user\",\r\n      url : \"/user/edit\"\r\n      templateUrl : 'angular_app/views/user/edit_user.html'\r\n      controller : \"EditUserController\"\r\n\r\n    # login state\r\n    $stateProvider.state \"login\",\r\n      url : \"/\"\r\n      templateUrl : 'angular_app/views/login/login.html'\r\n      controller : \"LoginController\"\r\n    \r\n    # register state\r\n    $stateProvider.state \"register\",\r\n      url : '/register'\r\n      templateUrl : 'angular_app/views/register/register.html'\r\n      controller: 'RegisterController'\r\n\r\n    $stateProvider.state \"register_manager\",\r\n      url : '/register-manager'\r\n      templateUrl : 'angular_app/views/register/register_manager.html'\r\n      controller : 'RegisterManagerController'\r\n\r\n    # busniess state\r\n    $stateProvider.state \"org\",\r\n      url : '/org'\r\n      templateUrl : 'angular_app/views/org/org.html'\r\n      controller : 'OrgController'\r\n\r\n    $stateProvider.state \"org_admin\",\r\n      url: '/org-admin'\r\n      templateUrl : \"angular_app/views/org/org_admin.html\"\r\n      controller : 'OrgAdminController'\r\n\r\n    $stateProvider.state \"org_admin_team\",\r\n      url: '/org-admin-team'\r\n      templateUrl : \"angular_app/views/org/org_admin_team.html\"\r\n      controller : 'OrgAdminTeamController'\r\n\r\n    $stateProvider.state \"org_financials\",\r\n      url: '/org-financials'\r\n      templateUrl : \"angular_app/views/org/org_financials.html\"\r\n      controller : 'OrgFinancialsController'\r\n\r\n    # team state\r\n    $stateProvider.state \"team\",\r\n      url : '/team'\r\n      templateUrl : 'angular_app/views/team/team.html'\r\n      controller : 'TeamController'\r\n\r\n    $stateProvider.state 'team_manager_home',\r\n      url: '/team-manager-home'\r\n      templateUrl : 'angular_app/views/team/team_manager_home.html'\r\n      controller : 'TeamController'\r\n\r\n      \r\n    $stateProvider.state 'team_manager',\r\n      url: '/team-manager'\r\n      templateUrl : 'angular_app/views/team/team_manager.html'\r\n      controller : 'TeamController'\r\n\r\n    $stateProvider.state 'event',\r\n      url: '/event'\r\n      templateUrl : 'angular_app/views/event/event.html'\r\n      controller : 'EventController'\r\n\r\n    $stateProvider.state 'password-reminder',\r\n      url: '/password/remind'\r\n      templateUrl : 'angular_app/views/password_reminder/password_reminder.html'\r\n      controller : 'PasswordReminderController'\r\n\r\n    $stateProvider.state 'password-reset',\r\n      url: '/password/reset'\r\n      templateUrl : 'angular_app/views/password_reminder/password_reset.html'\r\n      controller : 'PasswordReminderController'\r\n\r\n\r\n\r\nangular.module('subzapp').constant 'RESOURCES', do ->\r\n  # Define your variable\r\n  console.log \"url\" + window.location.origin \r\n  url = window.location.origin \r\n  # url = \"https://subzapp.herokuapp.com\"\r\n  # Use the variable in your constants\r\n  {\r\n    DOMAIN: url\r\n    # USERS_API: resource + '/users'\r\n    # BASIC_INFO: resource + '/api/info'\r\n  }\r\n  \r\n  \r\n\r\nangular.module('subzapp').service 'user', ($http, $state, RESOURCES, $rootScope, alertify ) ->\r\n  console.log \"user service\"\r\n  {\r\n\r\n    check_if_org_admin: ( user, id ) -> #check if user is org admin of club referenced by id\r\n      return parseInt( user.orgs[0].id ) == parseInt( id )\r\n\r\n    get_user: ->\r\n      \r\n      console.log \"yyyyyyyyyyyyyyyyyyy\"\r\n      user_token = window.localStorage.getItem 'user_token'\r\n      id = window.localStorage.getItem 'user_id'\r\n\r\n      # console.log \" token #{ user_token }\"\r\n      # console.log \"id #{ id }\"\r\n      $http(\r\n        method: 'GET'\r\n        url: \"#{ RESOURCES.DOMAIN }/user/#{ id }\"\r\n        headers: { 'Authorization': \"JWT #{ user_token }\", \"Content-Type\": \"application/json\" }\r\n      ).success( (data) ->\r\n        # console.log \"Fetched user data\"\r\n        # console.log data\r\n        if !(data?)\r\n          $state.go 'login'\r\n          console.log \"No user data\"\r\n          return false\r\n        else\r\n          console.log \"Got user\"\r\n          if data.length <= 0\r\n            alertify.error \"No user data\"\r\n            $state.go 'login'\r\n            return false\r\n          $rootScope.USER = data\r\n          return data\r\n        \r\n      ).catch (err) ->\r\n        console.log \"Fetching user data error #{ JSON.stringify err }\"\r\n        $state.go 'login'\r\n  }\r\n    \r\nangular.module('subzapp').service 'COMMS', ( $http, $state, RESOURCES, $rootScope, $q, usSpinnerService ) ->\r\n  console.log \"comms service\"\r\n  \r\n  POST: ( url, data ) ->\r\n    user_token = window.localStorage.getItem 'user_token'\r\n    usSpinnerService.spin('spinner-1')\r\n    $q ( resolve, reject ) ->\r\n      $http(\r\n        method: 'POST'\r\n        url: \"#{ RESOURCES.DOMAIN }#{ url }\"\r\n        headers: { \r\n                    'Authorization': \"JWT #{ user_token }\"\r\n                    \"Content-Type\": \"application/json\"\r\n                  }\r\n        data: data\r\n      ).then( ( result ) ->\r\n        usSpinnerService.stop('spinner-1')\r\n        if result.user != undefined\r\n          $rootScope.USER = result.user\r\n        resolve result\r\n      ).catch( ( err_result ) ->\r\n        usSpinnerService.stop('spinner-1')\r\n        reject err_result\r\n      )\r\n        \r\n\r\n  GET: ( url, data ) ->\r\n    user_token = window.localStorage.getItem 'user_token'\r\n    usSpinnerService.spin('spinner-1')\r\n    $q ( resolve, reject ) ->\r\n      $http(\r\n        method: 'GET'\r\n        url: \"#{ RESOURCES.DOMAIN }#{ url }\"\r\n        headers: { \r\n                    'Authorization': \"JWT #{ user_token }\"\r\n                    \"Content-Type\": \"application/json\"\r\n                  }\r\n        params: data\r\n      ).then( ( result ) ->\r\n        usSpinnerService.stop('spinner-1')\r\n        resolve result\r\n      ).catch( ( err_result ) ->\r\n        usSpinnerService.stop('spinner-1')\r\n        reject err_result\r\n      )\r\n\r\n  DELETE: ( url, data ) ->\r\n    user_token = window.localStorage.getItem 'user_token'\r\n    usSpinnerService.spin('spinner-1')\r\n    $q ( resolve, reject ) ->\r\n      $http(\r\n        method: 'DELETE'\r\n        url: \"#{ RESOURCES.DOMAIN }#{ url }\"\r\n        headers: { \r\n                    'Authorization': \"JWT #{ user_token }\"\r\n                    \"Content-Type\": \"application/json\"\r\n                  }\r\n        data: data \r\n      ).then( ( deleted ) ->\r\n        usSpinnerService.stop('spinner-1')\r\n        resolve deleted\r\n      ).catch( ( err_deleting ) ->\r\n        usSpinnerService.stop('spinner-1')\r\n        reject err_deleting\r\n      )\r\n"]}