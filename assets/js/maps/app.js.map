{"version":3,"sources":["app.coffee"],"names":[],"mappings":"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","file":"app.js","sourceRoot":"/source/","sourcesContent":["#Global variable for logged in user\n\nwindow.USER = null\n\n# See user service\n\n'use strict'\n\nangular.module('subzapp', [\n    'ngAnimate'\n    'ui.router'\n    'ngRoute'\n    'ui.bootstrap.datetimepicker'\n    \"ngAlertify\"\n    'ngFileUpload'\n    \"checklist-model\"\n])\n\nangular.module('subzapp').constant('API', 'api/v1/')\n  \n#routes, using angular-ui-router\nangular.module('subzapp').config ($stateProvider, $urlRouterProvider) ->\n\n    $urlRouterProvider.otherwise \"/\"\n\n    $stateProvider.state \"user\",\n      url : \"/user\"\n      templateUrl : 'angular_app/views/user/user.html'\n      controller : \"UserController\"\n\n    $stateProvider.state \"edit-user\",\n      url : \"/user/edit\"\n      templateUrl : 'angular_app/views/user/edit_user.html'\n      controller : \"EditUserController\"\n\n    # login state\n    $stateProvider.state \"login\",\n      url : \"/\"\n      templateUrl : 'angular_app/views/login/login.html'\n      controller : \"LoginController\"\n    \n    # register state\n    $stateProvider.state \"register\",\n      url : '/register'\n      templateUrl : 'angular_app/views/register/register.html'\n      controller: 'RegisterController'\n\n    $stateProvider.state \"register_manager\",\n      url : '/register-manager'\n      templateUrl : 'angular_app/views/register/register_manager.html'\n      controller : 'RegisterManagerController'\n\n    # busniess state\n    $stateProvider.state \"org\",\n      url : '/org'\n      templateUrl : 'angular_app/views/org/org.html'\n      controller : 'OrgController'\n\n    $stateProvider.state \"org_admin\",\n      url: '/org_admin'\n      templateUrl : \"angular_app/views/org/org_admin.html\"\n      controller : 'OrgAdminController'\n\n    $stateProvider.state \"org_admin_team\",\n      url: '/org_admin_team'\n      templateUrl : \"angular_app/views/org/org_admin_team.html\"\n      controller : 'OrgAdminTeamController'\n\n    # team state\n    $stateProvider.state \"team\",\n      url : '/team'\n      templateUrl : 'angular_app/views/team/team.html'\n      controller : 'TeamController'\n\n    $stateProvider.state 'team_manager_home',\n      url: '/team-manager-home'\n      templateUrl : 'angular_app/views/team/team_manager_home.html'\n      controller : 'TeamController'\n\n      \n    $stateProvider.state 'team_manager',\n      url: '/team-manager'\n      templateUrl : 'angular_app/views/team/team_manager.html'\n      controller : 'TeamController'\n\n    $stateProvider.state 'event',\n      url: '/event'\n      templateUrl : 'angular_app/views/event/event.html'\n      controller : 'EventController'\n\n    $stateProvider.state 'password-reminder',\n      url: '/password/remind'\n      templateUrl : 'angular_app/views/password_reminder/password_reminder.html'\n      controller : 'PasswordReminderController'\n\n    $stateProvider.state 'password-reset',\n      url: '/password/reset'\n      templateUrl : 'angular_app/views/password_reminder/password_reset.html'\n      controller : 'PasswordReminderController'\n\n\n\nangular.module('subzapp').constant 'RESOURCES', do ->\n  # Define your variable\n  console.log \"url\" + window.location.origin \n  url = window.location.origin \n  # url = \"https://subzapp.herokuapp.com\"\n  # Use the variable in your constants\n  {\n    DOMAIN: url\n    # USERS_API: resource + '/users'\n    # BASIC_INFO: resource + '/api/info'\n  }\n  \n  \n\nangular.module('subzapp').service 'user', ($http, $state, RESOURCES ) ->\n  console.log \"user service\"\n  {\n\n    check_if_org_admin: ( user, id ) -> #check if user is org admin of club referenced by id\n      return parseInt( user.orgs[0].id ) == parseInt( id )\n\n    get_user: ->\n      \n      console.log \"yyyyyyyyyyyyyyyyyyy\"\n      user_token = window.localStorage.getItem 'user_token'\n      id = window.localStorage.getItem 'user_id'\n\n      # console.log \" token #{ user_token }\"\n      # console.log \"id #{ id }\"\n      $http(\n        method: 'GET'\n        url: \"#{ RESOURCES.DOMAIN }/user/#{ id }\"\n        headers: { 'Authorization': \"JWT #{ user_token }\", \"Content-Type\": \"application/json\" }\n      ).success( (data) ->\n        console.log \"Fetched user data\"\n        console.log data\n        if !(data?)\n          $state.go 'login'\n          console.log \"No user data\"\n          return false\n        else\n          console.log \"Got user\"\n          # console.log data\n          window.USER = data\n          return data\n        \n      ).error (err) ->\n        console.log \"Fetching user data error #{ JSON.stringify err }\"\n        $state.go 'login'\n  }\n    \n"]}